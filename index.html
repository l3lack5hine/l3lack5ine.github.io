<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>คำนวณเป้าหมายผลผลิตตามประสิทธิภาพ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        /* --- Global Styles --- */
        body {
            font-family: 'Arial', 'Helvetica Neue', sans-serif; /* เพิ่ม fallback fonts */
            padding: 20px;
            margin: 0;
            background-color: #f4f4f9; /* สีพื้นหลังอ่อนโยน */
            color: #333; /* สีตัวอักษรหลัก */
            line-height: 1.6; /* เพิ่มระยะห่างบรรทัดให้อ่านง่าย */
        }

        /* --- Container --- */
        .container {
            max-width: 650px; /* เพิ่มความกว้างเล็กน้อย */
            margin: 20px auto; /* ปรับ margin */
            padding: 25px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); /* ปรับเงาให้ดูนุ่มนวลขึ้น */
        }

        /* --- Headings and Text --- */
        h1 {
            font-size: 26px; /* ปรับขนาด font */
            text-align: center;
            color: #2c3e50; /* สีหัวข้อเข้มขึ้น */
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-size: 16px;
            font-weight: bold;
            color: #555;
        }

        /* --- Form Elements --- */
        input[type="number"], 
        button {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px; /* ปรับ margin ด้านล่าง */
            box-sizing: border-box;
            font-size: 16px;
            border: 1px solid #ddd; /* สีขอบอ่อนลง */
            border-radius: 5px; /* ความโค้งมน */
        }

        input[type="number"]:focus {
            border-color: #007bff; /* เปลี่ยนสีขอบเมื่อ focus */
            box-shadow: 0 0 5px rgba(0,123,255,0.25); /* เพิ่มเงาเมื่อ focus */
            outline: none; /* เอา outline เริ่มต้นออก */
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease; /* เพิ่ม transition */
        }

        button:hover {
            background-color: #0056b3;
        }
        button:active {
            transform: scale(0.98); /* เอฟเฟกต์เมื่อกดปุ่ม */
        }

        /* --- Result Area --- */
        .result {
            margin-top: 25px;
            padding: 20px;
            background: #eef1f5; /* สีพื้นหลังผลลัพธ์ */
            border-left: 5px solid #007bff; /* เพิ่มแถบสีด้านซ้าย */
            border-radius: 5px;
        }
        .result h3 {
            margin-top: 0;
            color: #007bff;
        }
        .result p {
            margin-bottom: 8px; /* ลดระยะห่างระหว่าง p ใน result */
        }

        /* --- Error Message Styling --- */
        .error-message h3 {
            color: #dc3545 !important; /* สีแดงสำหรับหัวข้อข้อผิดพลาด */
        }
        .error-message p {
            color: #dc3545; /* สีแดงสำหรับข้อความข้อผิดพลาด */
        }


        /* --- Animation --- */
        @keyframes smooth-blink-effect {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        .smooth-blinking-text {
            animation-name: smooth-blink-effect;
            animation-duration: 1.8s; /* ปรับความเร็วเล็กน้อย */
            animation-iteration-count: infinite;
            font-weight: bold;
        }

        /* --- Responsive Adjustments --- */
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            .container {
                margin: 10px;
                padding: 15px;
            }
            h1 {
                font-size: 22px;
            }
            input[type="number"], button {
                padding: 10px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>คำนวณเป้าหมายผลผลิตรายวัน</h1>
        <form id="calcForm" onsubmit="event.preventDefault(); calculate();"> <label for="sam">SAM Style (นาที/ชิ้น):</label>
            <input type="number" step="0.01" id="sam" required>

            <label for="morningPeople">จำนวนคนทำงานช่วงเช้า (4 ชม.):</label>
            <input type="number" id="morningPeople" required>

            <label for="afternoonPeople">จำนวนคนทำงานช่วงบ่าย (4 ชม.):</label>
            <input type="number" id="afternoonPeople" required>

            <label for="otPeople">จำนวนคนทำงาน OT:</label>
            <input type="number" id="otPeople" required>

            <label for="otHours">ชั่วโมง OT/วัน (ใส่เฉพาะ ชม.โอที):</label>
            <input type="number" id="otHours" required>

            <label for="targetEff">เปอร์เซ็นต์ประสิทธิภาพที่ต้องการ (%):</label>
            <input type="number" step="0.01" id="targetEff" required>

            <button type="button" onclick="calculate()">คำนวณ</button>
        </form>

        <div id="result" class="result" role="alert" aria-live="assertive">
            </div>
    </div>

    <script>
        function calculate() {
            // --- 1. Read and Parse Input Values ---
            const sam = parseFloat(document.getElementById('sam').value);
            const morningPeople = parseFloat(document.getElementById('morningPeople').value);
            const afternoonPeople = parseFloat(document.getElementById('afternoonPeople').value);
            const otPeople = parseFloat(document.getElementById('otPeople').value);
            const otHours = parseFloat(document.getElementById('otHours').value);
            const targetEffInput = parseFloat(document.getElementById('targetEff').value); // ค่า % ประสิทธิภาพที่ผู้ใช้กรอก

            const resultDiv = document.getElementById('result'); // เก็บ element ของ result div

            // --- 2. Validate Inputs ---
            // Clear previous results or errors
            resultDiv.innerHTML = ''; 
            resultDiv.className = 'result'; // Reset class

            if (isNaN(sam) || isNaN(morningPeople) || isNaN(afternoonPeople) || isNaN(otPeople) || isNaN(otHours) || isNaN(targetEffInput)) {
                resultDiv.className = 'result error-message'; // Add error class
                resultDiv.innerHTML = `
                    <h3>ข้อผิดพลาด:</h3>
                    <p>กรุณากรอกข้อมูลให้ครบทุกช่องด้วยตัวเลขที่ถูกต้อง</p>
                `;
                return;
            }

            let errorMessage = '';
            if (sam <= 0) {
                errorMessage = 'ค่า SAM Style ต้องมากกว่า 0';
            } else if (morningPeople < 0) {
                errorMessage = 'จำนวนคนทำงานช่วงเช้าต้องไม่ติดลบ';
            } else if (afternoonPeople < 0) {
                errorMessage = 'จำนวนคนทำงานช่วงบ่ายต้องไม่ติดลบ';
            } else if (otPeople < 0) {
                errorMessage = 'จำนวนคนทำงาน OT ต้องไม่ติดลบ';
            } else if (otHours < 0) {
                errorMessage = 'ชั่วโมง O.T. ต้องไม่ติดลบ';
            } else if (targetEffInput < 0) { // โดยทั่วไป targetEff ควรมากกว่า 0 ด้วย แต่ตามโค้ดเดิมคือไม่ติดลบ
                errorMessage = 'เปอร์เซ็นต์ประสิทธิภาพที่ต้องการต้องไม่ติดลบ';
            }

            if (errorMessage) {
                resultDiv.className = 'result error-message'; // Add error class
                resultDiv.innerHTML = `
                    <h3>ข้อผิดพลาด:</h3>
                    <p class="smooth-blinking-text">${errorMessage}</p>
                `;
                return;
            }

            // --- 3. Perform Calculations ---
            // เวลาทำงานปกติ (นาที)
            const normalWorkMinutesMorning = morningPeople * 4 * 60;
            const normalWorkMinutesAfternoon = afternoonPeople * 4 * 60;
            const totalNormalWorkMinutes = normalWorkMinutesMorning + normalWorkMinutesAfternoon;

            // เวลาทำงาน 6 ชั่วโมง (เช่น ถึง 15:30 น. หากเริ่ม 08:00 น. และพักกลางวัน 1 ชั่วโมง)
            // สมมติว่าช่วงบ่ายนับแค่ 2 ชั่วโมงสำหรับเป้าหมายนี้
            const first6HoursWorkMinutes = normalWorkMinutesMorning + (afternoonPeople * 2 * 60); 

            // เวลาทำงาน OT (นาที)
            const otWorkMinutes = otPeople * otHours * 60;

            // เวลารวมทั้งหมด (นาที)
            const totalAvailableMinutes = totalNormalWorkMinutes + otWorkMinutes;
            // const totalAvailableHours = totalAvailableMinutes / 60; // ไม่ได้ใช้ในการแสดงผล จึงคอมเมนต์ไว้

            // ผลผลิตที่คาดหวังหากประสิทธิภาพเป็น 100%
            const expectedOutputAt100Eff_Total = totalAvailableMinutes / sam;
            const expectedOutputAt100Eff_6Hours = first6HoursWorkMinutes / sam;

            // ปรับเป้าหมายประสิทธิภาพ: เพิ่ม 0.05% เข้าไปในค่าที่ผู้ใช้กรอก
            // เช่น ถ้าผู้ใช้กรอก 60 (สำหรับ 60%), ค่าที่ใช้คำนวณคือ 60.05%
            const adjustedTargetEffPercentage = (targetEffInput + 0.05) / 100;

            // จำนวนงานที่ต้องทำเพื่อให้ได้ตาม Target EFF% ที่ปรับแล้ว
            const requiredOutput_Total = adjustedTargetEffPercentage * expectedOutputAt100Eff_Total;
            const requiredOutput_6Hours = adjustedTargetEffPercentage * expectedOutputAt100Eff_6Hours;

            // --- 4. Display Results ---
            resultDiv.innerHTML = `
                <h3>ผลลัพธ์การคำนวณ:</h3>
                <p>ผลผลิตที่คาดหวัง (เมื่อประสิทธิภาพ 100% ตลอดเวลาทำงานรวม OT): <strong>${expectedOutputAt100Eff_Total.toFixed(2)} ตัว</strong></p>
                <p>ผลผลิตที่คาดหวัง (เมื่อประสิทธิภาพ 100% ณ 6 ชม.ทำงาน): <strong>${expectedOutputAt100Eff_6Hours.toFixed(2)} ตัว</strong></p>
                <hr>
                <p>เป้าหมายประสิทธิภาพที่ตั้งไว้ (จาก Input): <strong>${targetEffInput.toFixed(2)}%</strong></p>
                <p>เป้าหมายประสิทธิภาพที่ใช้คำนวณจริง (Input + 0.05%): <strong>${(adjustedTargetEffPercentage * 100).toFixed(2)}%</strong></p>
                <p style="font-size: 1.1em; margin-top:10px;"><strong>จำนวนงานที่ต้องทำ ณ 6 ชั่วโมงทำงาน (คำนวณจากประสิทธิภาพ ${(adjustedTargetEffPercentage * 100).toFixed(2)}%): <span style="color: #007bff; font-size: 1.2em;">${requiredOutput_6Hours.toFixed(2)} ตัว</span></strong></p>
                <p style="font-size: 1.1em;"><strong>จำนวนงานที่ต้องทำทั้งหมดต่อวัน (คำนวณจากประสิทธิภาพ ${(adjustedTargetEffPercentage * 100).toFixed(2)}%): <span style="color: #007bff; font-size: 1.2em;">${requiredOutput_Total.toFixed(2)} ตัว</span></strong></p>
                <p style="margin-top: 15px;"><span style="color: #dc3545;" class="smooth-blinking-text"><strong>*** หมายเหตุ: เป้าหมายผลผลิตนี้ ได้ใช้ค่าประสิทธิภาพที่ผู้ใช้กรอกบวกเพิ่มอีก 0.05% ในการคำนวณแล้ว ***</strong></span></p>
            `;
        }
    </script>
</body>
</html>
